"use strict";(self["webpackChunkmushop"]=self["webpackChunkmushop"]||[]).push([[523],{2698:function(t,e,a){a.d(e,{R:function(){return n}});var c=a(2119);const n=()=>{const t=(0,c.tv)(),e=()=>{t.back()};return{toBack:e}}},5143:function(t,e,a){a.d(e,{V:function(){return s}});var c=a(6252),n=a(3907);const s=t=>{const e=(0,n.oR)(),a=e.state.cartList,s=(t,a,c,n)=>{e.commit("changeItemQuantity",{shopId:t,productId:a,item:c,num:n})},o=(0,c.Fl)((()=>{const e=a[t]?.productList||{};let c={};for(let t in e){const a=e[t];a.count>0&&(c[t]=a)}return c})),i=(0,c.Fl)((()=>{const e=a[t]?.productList||{};let c={};for(let t in e){const a=e[t];a.check&&a.count>0&&(c[t]=a)}return c})),r=(0,c.Fl)((()=>a[t]?.shopName||"")),_=(0,c.Fl)((()=>{const e=a[t]?.productList;let c={total:0,sum:0,allChecked:!0};if(e)for(const t in e){const a=e[t];c.total+=a.count,a.check&&(c.sum+=a.price*a.count),a.count>0&&!a.check&&(c.allChecked=!1)}return c.sum=c.sum.toFixed(2),c}));return{cartList:a,productList:o,Calculations:_,shopName:r,orderedProductList:i,changeItemQuantity:s}}},1385:function(t,e,a){a.d(e,{Z:function(){return k}});var c=a(6252),n=a(3577);const s={class:"shop__item"},o={class:"shop__item__img"},i=["src"],r={class:"shop__content__title"},_={class:"shop__content__tags"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__tag"},m={class:"shop__content__slogan"};function p(t,e,a,p,h,C){return(0,c.wg)(),(0,c.iD)("div",s,[(0,c._)("div",o,[(0,c._)("img",{src:a.item.imgUrl},null,8,i)]),(0,c._)("div",{class:(0,n.C_)({shop__item__content:!0,"shop__item--bordered":!a.hideBorder})},[(0,c._)("div",r,(0,n.zw)(a.item.name),1),(0,c._)("div",_,[(0,c._)("span",l," 月售："+(0,n.zw)(a.item.sales),1),(0,c._)("span",d," 起送："+(0,n.zw)(a.item.expressLimit),1),(0,c._)("span",u," 基础运费："+(0,n.zw)(a.item.expressPrice),1)]),(0,c._)("div",m,(0,n.zw)(a.item.slogan),1)],2)])}var h={name:"ShopInfo",props:["item","hideBorder"]},C=a(3744);const g=(0,C.Z)(h,[["render",p],["__scopeId","data-v-bf8f957c"]]);var k=g},4360:function(t,e,a){a.r(e),a.d(e,{default:function(){return Lt}});var c=a(6252),n=a(9963);const s=t=>((0,c.dD)("data-v-43f12b38"),t=t(),(0,c.Cn)(),t),o={class:"wrapper"},i={class:"search"},r=s((()=>(0,c._)("span",{class:"iconfont search_icon"},"",-1))),_=s((()=>(0,c._)("input",{type:"text",placeholder:"请输入商品名称搜索"},null,-1)));function l(t,e,a,s,l,d){const u=(0,c.up)("ShopInfo"),m=(0,c.up)("ContentPart"),p=(0,c.up)("CartPart");return(0,c.wg)(),(0,c.iD)("div",o,[(0,c._)("div",i,[(0,c._)("div",{class:"iconfont search__back",onClick:e[0]||(e[0]=(...t)=>s.toBack&&s.toBack(...t))},""),r,_]),(0,c.wy)((0,c.Wm)(u,{item:s.item,hideBorder:!0},null,8,["item"]),[[n.F8,s.item.imgUrl]]),(0,c.Wm)(m,{shopName:s.item.name},null,8,["shopName"]),(0,c.Wm)(p)])}var d=a(2119),u=a(2262),m=a(4471),p=a(1385),h=a(3577);const C=t=>((0,c.dD)("data-v-1878b11a"),t=t(),(0,c.Cn)(),t),g={class:"content"},k={class:"category"},v=["onClick"],w={class:"product"},I=["src"],b={class:"product__item__detail"},f={class:"product__item__title"},y={class:"product__item__sales"},D={class:"product__item__price"},L={class:"product__item__yen"},z=C((()=>(0,c._)("em",null,"￥",-1))),P={class:"product__item__origin"},Q={class:"product__number"},S=["onClick"],T={class:"product__number__text"},H=["onClick"];function B(t,e,a,n,s,o){return(0,c.wg)(),(0,c.iD)("div",g,[(0,c._)("div",k,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(n.categories,(t=>((0,c.wg)(),(0,c.iD)("div",{class:(0,h.C_)({category__item:!0,"category__item--active":n.currentTab===t.tab}),key:t.tab,onClick:()=>{n.handleTabClick(t.tab)}},(0,h.zw)(t.name),11,v)))),128))]),(0,c._)("div",w,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(n.list,(t=>((0,c.wg)(),(0,c.iD)("div",{class:"product__item",key:t._id},[(0,c._)("img",{class:"product__item__img",src:t.imgUrl},null,8,I),(0,c._)("div",b,[(0,c._)("h4",f,(0,h.zw)(t.name),1),(0,c._)("p",y,"月售 "+(0,h.zw)(t.sales)+" 件",1),(0,c._)("p",D,[(0,c._)("span",L,[z,(0,c._)("i",null,(0,h.zw)(t.price),1)]),(0,c._)("span",P,"￥"+(0,h.zw)(t.oldPrice),1)])]),(0,c._)("div",Q,[(0,c._)("span",{class:"product__number__minus",onClick:()=>{n.changeCartItem(n.shopId,t._id,t,-1,a.shopName)}},"-",8,S),(0,c._)("span",T,(0,h.zw)(n.getItemQuantity(n.shopId,t._id)),1),(0,c._)("span",{class:"product__number__plus",onClick:()=>{n.changeCartItem(n.shopId,t._id,t,1,a.shopName)}},"+",8,H)])])))),128))])])}var N=a(5143),U=a(3907);const q=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"水果",tab:"fruit"}],x=()=>{const t=(0,u.iH)(q[0].tab),e=e=>{t.value=e};return{currentTab:t,handleTabClick:e}},F=(t,e)=>{const a=(0,u.iH)([]),n=async()=>{const c=await(0,m.U)(`/api/shop/${e}/products`,{tab:t.value});0===c?.errno&&c?.data?.length&&(a.value=c.data)};return(0,c.m0)((()=>{n()})),{list:a}},Z=()=>{const{cartList:t,changeItemQuantity:e}=(0,N.V)(),a=(0,U.oR)(),c=(t,e)=>{a.commit("changeShopName",{shopId:t,shopName:e})},n=(t,a,n,s,o)=>{e(t,a,n,s),c(t,o)},s=(e,a)=>t?.[e]?.productList?.[a]?.count||0;return{changeCartItem:n,getItemQuantity:s}};var A={name:"ContentPart",props:["shopName"],setup(){const t=(0,d.yj)(),e=t.params.id,{currentTab:a,handleTabClick:c}=x(),{list:n}=F(a,e),{changeCartItem:s,getItemQuantity:o}=Z();return{categories:q,list:n,currentTab:a,handleTabClick:c,shopId:e,changeCartItem:s,getItemQuantity:o}}},R=a(3744);const j=(0,R.Z)(A,[["render",B],["__scopeId","data-v-1878b11a"]]);var K=j;const M=t=>((0,c.dD)("data-v-d88b1828"),t=t(),(0,c.Cn)(),t),V={class:"cart"},W={key:0,class:"product"},Y={key:0,class:"product__header"},$=["innerHTML"],E=(0,c.Uk)(" 全选 "),G=["innerHTML","onClick"],J=["src"],O={class:"product__item__detail"},X={class:"product__item__title"},tt={class:"product__item__price"},et={class:"product__item__yen"},at=M((()=>(0,c._)("em",null,"￥",-1))),ct={class:"product__item__origin"},nt={class:"product__number"},st=["onClick"],ot={class:"product__number__text"},it=["onClick"],rt={class:"check"},_t={class:"check__icon"},lt={key:0,class:"check__icon__tag"},dt={class:"check__info"},ut=(0,c.Uk)(" 总计："),mt={class:"check__info__price"},pt={key:0,class:"check__btn"},ht=(0,c.Uk)(" 去结算 ");function Ct(t,e,a,n,s,o){const i=(0,c.up)("router-link");return(0,c.wg)(),(0,c.iD)(c.HY,null,[n.showCart&&n.Calculations.total>0?((0,c.wg)(),(0,c.iD)("div",{key:0,class:"mask",onClick:e[0]||(e[0]=(...t)=>n.handleCartShowChange&&n.handleCartShowChange(...t))})):(0,c.kq)("",!0),(0,c._)("div",V,[n.showCart?((0,c.wg)(),(0,c.iD)("div",W,[n.Calculations.total>0?((0,c.wg)(),(0,c.iD)("div",Y,[(0,c._)("div",{class:"product__header__all",onClick:e[1]||(e[1]=()=>n.setItemAllChecked(n.shopId))},[(0,c._)("span",{class:"product__header__icon iconfont",innerHTML:n.Calculations.allChecked?"":""},null,8,$),E]),(0,c._)("div",{class:"product__header__clear",onClick:e[2]||(e[2]=()=>n.cleanCartProducts(n.shopId))}," 清空购物车 ")])):(0,c.kq)("",!0),((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(n.productList,((t,e)=>((0,c.wg)(),(0,c.iD)("div",{class:"product__item",key:e},[(0,c._)("div",{class:"product__item__checked iconfont",innerHTML:t.check?"":"",onClick:()=>{n.changeItemChecked(n.shopId,t._id)}},null,8,G),(0,c._)("img",{class:"product__item__img",src:t.imgUrl},null,8,J),(0,c._)("div",O,[(0,c._)("h4",X,(0,h.zw)(t.name),1),(0,c._)("p",tt,[(0,c._)("span",et,[at,(0,c._)("i",null,(0,h.zw)(t.price),1)]),(0,c._)("span",ct,"￥"+(0,h.zw)(t.oldPrice),1)])]),(0,c._)("div",nt,[(0,c._)("span",{class:"product__number__minus",onClick:()=>{n.changeItemQuantity(n.shopId,t._id,t,-1)}},"-",8,st),(0,c._)("span",ot,(0,h.zw)(t.count||0),1),(0,c._)("span",{class:"product__number__plus",onClick:()=>{n.changeItemQuantity(n.shopId,t._id,t,1)}},"+",8,it)])])))),128))])):(0,c.kq)("",!0),(0,c._)("div",rt,[(0,c._)("div",_t,[(0,c._)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",class:"check__icon__img",onClick:e[3]||(e[3]=(...t)=>n.handleCartShowChange&&n.handleCartShowChange(...t))}),n.Calculations.total>0?((0,c.wg)(),(0,c.iD)("div",lt,(0,h.zw)(n.Calculations.total),1)):(0,c.kq)("",!0)]),(0,c._)("div",dt,[ut,(0,c._)("span",mt,"￥"+(0,h.zw)(n.Calculations.sum),1)]),n.Calculations.sum>0?((0,c.wg)(),(0,c.iD)("div",pt,[(0,c.Wm)(i,{to:{path:`/order/${n.shopId}`}},{default:(0,c.w5)((()=>[ht])),_:1},8,["to"])])):(0,c.kq)("",!0)])])],64)}const gt=()=>{const t=(0,u.iH)(!1),e=()=>{t.value=!t.value};return{showCart:t,handleCartShowChange:e}},kt=t=>{const{productList:e,Calculations:a,changeItemQuantity:c}=(0,N.V)(t),n=(0,U.oR)(),s=t=>{n.commit("setItemAllChecked",t)},o=t=>{n.commit("cleanCartProducts",t)},i=(t,e)=>{n.commit("changeItemChecked",{shopId:t,productId:e})};return{productList:e,Calculations:a,changeItemQuantity:c,setItemAllChecked:s,cleanCartProducts:o,changeItemChecked:i}};var vt={name:"CartPart",setup(){const t=(0,d.yj)(),e=t.params.id,{showCart:a,handleCartShowChange:c}=gt(),{productList:n,Calculations:s,changeItemQuantity:o,setItemAllChecked:i,cleanCartProducts:r,changeItemChecked:_}=kt(e);return{showCart:a,shopId:e,productList:n,Calculations:s,handleCartShowChange:c,changeItemQuantity:o,setItemAllChecked:i,cleanCartProducts:r,changeItemChecked:_}}};const wt=(0,R.Z)(vt,[["render",Ct],["__scopeId","data-v-d88b1828"]]);var It=wt,bt=a(2698);const ft=()=>{const t=(0,d.yj)(),e=(0,u.qj)({item:{}}),a=async()=>{const a=await(0,m.U)(`/api/shop/${t.params.id}`);0===a?.errno&&a?.data&&(e.item=a.data)},{item:c}=(0,u.BK)(e);return{item:c,getItemData:a}};var yt={name:"ShopView",components:{ShopInfo:p.Z,ContentPart:K,CartPart:It},setup(){const{item:t,getItemData:e}=ft();e();const{toBack:a}=(0,bt.R)();return{item:t,toBack:a}}};const Dt=(0,R.Z)(yt,[["render",l],["__scopeId","data-v-43f12b38"]]);var Lt=Dt}}]);
//# sourceMappingURL=shop.fe0c5370.js.map